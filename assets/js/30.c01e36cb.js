(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{378:function(n,t,e){"use strict";e.r(t);var a=e(43),s=Object(a.a)({},(function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"nginx-反向代理基础使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nginx-反向代理基础使用"}},[n._v("#")]),n._v(" nginx 反向代理基础使用")]),n._v(" "),e("img",{attrs:{src:n.$withBase("/image/nginx.png")}}),n._v(" "),e("h2",{attrs:{id:"项目使用场景"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#项目使用场景"}},[n._v("#")]),n._v(" 项目使用场景")]),n._v(" "),e("ol",[e("li",[e("p",[n._v("在需要进行外部请求时，发生跨域错误，此时用到nginx反向代理，在http/server/location中添加指定url匹配，\n并把匹配到的请求转发到实际需要请求的外部地址，解决跨域问题。")])]),n._v(" "),e("li",[e("p",[n._v("在服务器挂掉时可以用作本地服务器，将build好的前端代码路径添加到http/server/location/root项中，\n添加监听的端口与本地ip，就可以作为本地服务器进行访问。")])])]),n._v(" "),e("p",[n._v("Nginx在做反向代理时，提供性能稳定，并且能够提供配置灵活的转发功能。Nginx可以根据不同的正则匹配，\n采取不同的转发策略，比如图片文件结尾的走文件服务器，动态页面走web服务器，只要你正则写的没问题，\n又有相对应的服务器解决方案，你就可以随心所欲的玩。并且Nginx对返回结果进行错误页跳转，异常判断等。\n如果被分发的服务器存在异常，他可以将请求重新转发给另外一台服务器，然后自动去除异常服务器。")]),n._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[n._v("//基础命令")]),n._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[n._v("//启动：")]),n._v("\n    start nginx\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[n._v("//重启")]),n._v("\n    nginx "),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("-")]),n._v("s reload\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[n._v("//关闭")]),n._v("\n    nginx "),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("-")]),n._v("s stop\n    \n")])])]),e("blockquote",[e("p",[n._v("nginx.conf文件配置")])]),n._v(" "),e("div",{staticClass:"language-conf extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("#nginx.conf\n#句尾分号不可缺少\n#http块：可以嵌套多个server，配置代理，缓存\nhttp {\n    include         mime.types; #文件拓展名与文件类型映射表\n    default_type    application/octet-stream; #默认文件类型，默认为text/plain\n\n    #access_log  logs/access.log  main; #取消日志服务\n\n    sendfile        on; #允许sendfile方式传输文件，默认为off\n    #tcp_nopush     on;\n\n    keepalive_timeout  65; #连接超时时间，默认为75s\n\n    gzip  on; #开启gzip\n    gzip_vary on;\n    gzip_min_length 1k; #不压缩临界值,大于1k的才压缩,一般不用改\n    gzip_buffers 4 16k;\n    gzip_comp_level 8; #压缩级别,数字越大压缩的越好\n    gzip_types  text/plain application/javascript \n                application/x-javascript text/css application/xml \n                text/javascript application/x-httpd-php image/jpeg \n                image/gif image/png image/x-icon; #压缩文件类型,缺啥补啥\n\n\tclient_max_body_size 5m;\n\n    #server块，配置虚拟主机相关参数，一个http中可以有多个server\n    server {\n        listen       80; #监听端口\n        server_name  localhost; #监听地址\n        \n        #配置请求的路由， 一个server中可以有多个location\n        location / { #请求的url匹配，使用正则\n            root   D:/isafety-portal/docker/42/dist; #文件根目录\n            index  index.html index.htm; #默认页\n        }\n\n        location ~* \\.(eot|otf|ttf|woff|svg)$ { \n            root /opt/znv/isafety-portal;\n            add_header Access-Control-Allow-Origin *; #添加请求头\n        }\n\n        location ^~/api/ { #匹配/api/开头的请求\n            proxy_pass  http://10.72.74.73:20800/; #转发到指定地址\n            proxy_http_version 1.1;\n\t\t\tproxy_set_header Upgrade $http_upgrade;\n\t\t\tproxy_set_header Connection 'upgrade';\n            proxy_set_header Host $http_host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forward-For $proxy_add_x_forwarded_for;\n\t\t\tadd_header Access-Control-Allow-Credentials true;\n\t\t\tadd_header Access-Control-Allow-Origin *;\t\t\t\n\t\t\tadd_header Access-Control-Allow-Methods 'POST,GET,OPTIONS,PUT,DELETE';\n        }\n\n    }\n}\n\n")])])])])}),[],!1,null,null,null);t.default=s.exports}}]);